{% extends "base.html" %}
{% block title %}Manage User Access{% endblock %}

{% block body %}
<style>
    /* Dark Blue Header to match MMU branding */
    .admin-header { 
        background-color: #012d9e; 
        color: white; 
        padding: 25px; 
        margin-bottom: 20px; 
        border-radius: 0 0 8px 8px;
    }
    
    .container { width: 90%; margin: auto; }
    
    .user-table { 
        width: 100%; 
        border-collapse: collapse; 
        background: white; 
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .user-table th { 
        background-color: #f8f9fa; 
        padding: 15px; 
        text-align: left; 
        border-bottom: 2px solid #012d9e; 
    }
    
    .user-table td { padding: 15px; border-bottom: 1px solid #eee; }

    /* Role Badges matching your colorful logic */
    .badge { padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; }
    .badge-admin { background-color: #e8f5e9; color: #2e7d32; } /* Green for Admin */
    .badge-user { background-color: #e3f2fd; color: #1565c0; }  /* Blue for User */

    .update-btn { 
        background-color: #012d9e; 
        color: white; 
        border: none; 
        padding: 8px 15px; 
        border-radius: 4px; 
        cursor: pointer; 
    }
    
    .update-btn:hover { background-color: #012d9e; }
</style>

<div class="admin-header">
    <div class="container">
        <h1 style="margin: 0;">User Access Management</h1>
        <p style="margin: 5px 0;"><a href="{{ url_for('admin_dashboard') }}" style="color: #64b5f6; text-decoration: none;">‚Üê Return to Dashboard</a></p>
    </div>
</div>

<div class="container">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div style="background: #e8f5e9; color: #2e7d32; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <table class="user-table">
        <thead>
            <tr>
                <th>User ID</th>
                <th>Current Status</th>
                <th>Change Access Level</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td><strong>{{ user.UserID }}</strong></td>
                <td>
                    {% if user.AdminLevel == 1 %}
                        <span class="badge badge-admin">Administrator</span>
                    {% else %}
                        <span class="badge badge-user">Standard User</span>
                    {% endif %}
                </td>
                <td>
                    <form action="{{ url_for('update_user_role') }}" method="POST" style="display: flex; gap: 10px;">
                        <input type="hidden" name="userid" value="{{ user.UserID }}">
                        
                        <select name="admin_level" style="padding: 5px; border-radius: 4px;">
                            <option value="0" {% if user.AdminLevel == 0 %}selected{% endif %}>User</option>
                            <option value="1" {% if user.AdminLevel == 1 %}selected{% endif %}>Admin</option>
                        </select>
                        
                        <button type="submit" class="update-btn">Save Changes</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}